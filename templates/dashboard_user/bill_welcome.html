<!DOCTYPE html>
<html
  lang="en"
  class="light-style layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="../static/"
  data-template="vertical-menu-template-free"
>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"/>
    <title>Sale-Performance</title>
    <meta name="description" content="" />
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/favicon.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar/boxicons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar/core.css') }}" class="template-customizer-core-css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar/theme-default.css') }}" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar/demo.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar/perfect-scrollbar.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Anuphan:wght@100..700&display=swap" rel="stylesheet"> <!-- ตัวหนังสือ -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" /> <!-- ICON GOOGLE -->
    <link href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet"/>
    <script src="{{ url_for('static', filename='js/sidebar/helpers.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar/config.js') }}"></script>
    <style>
      .content {
        overflow-y: auto;
      }

      .app-brand-text1 {
        font-size: clamp(16px, 2vw, 24px);
      }

      @media print {
        @page {
          size: A4 ;
          margin-top: 0mm;
          margin-bottom: 0mm; 
        }

        body * {
          visibility: hidden;
          -webkit-print-color-adjust: exact;
        }
      
        .print-section, .print-section * {
          visibility: visible !important;
        }      
        
        .print-section {
          margin-top: 0;
          padding-top: 0;
          width: 100%;
          height: 100%;
          position: absolute;
          top: 0;
          left: 0;
          width: 250mm;
          height: 300mm;
          padding: 0px;
          background-color: white;
        }

        #welcome td {
          font-size: 12px;
        }

        .col-xl-6 {
          flex: 0 0 auto;
          width: 50%;
          font-size: 14px;
        }
      }
    </style>
  </head>

  <body style="font-family: 'Anuphan', sans-serif; color: #4e5257">
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">

        <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
            <div class="app-brand demo">
              <a href="{{ url_for('welcome' if session['user_level'] == 3 else 'welcome') }}" class="app-brand-link">
                <span class="app-brand-logo demo">
                  <img src="{{ url_for('static', filename='img/favicon.png') }}" alt="Logo" width="60">
                </span>
                <span class="app-brand-text demo menu-text fw-bolder ms-2">SALE-PERFORMANCE</span>
              </a>
              <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
                <i class="bx bx-chevron-left bx-sm align-middle"></i>
              </a>
            </div>
    
            <div class="menu-inner-shadow"></div>
    
            <ul class="menu-inner py-1">
              <li class="menu-item" style="cursor: pointer;">
                <a onclick="printPage()" class="menu-link" id="printButton">
                  <span class="material-symbols-outlined menu-icon">print</span>
                  <div data-i18n="Analytics">Print Invoice</div>
                </a>
              </li>
            </ul>
          </aside>

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->

        <nav
          class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
          id="layout-navbar"
        >
          <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
            <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
              <i class="bx bx-menu bx-sm"></i>
            </a>
          </div>

          <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
            <div class="navbar-nav align-items-center">
              <div class="nav-item d-flex align-items-center">
                <small class="text-muted">Date Time : {{current_time}}</small>
              </div>
            </div>

            <ul class="navbar-nav flex-row align-items-center ms-auto">
              <li class="nav-item navbar-dropdown dropdown-user dropdown">
                <a style="cursor: default;" class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown">
                  <div class="avatar avatar-online" style="cursor: default;">
                    <img src="{{ photo_url }}" alt="Logo" class="w-px-40 h-auto rounded-circle">
                  </div>
                </a>
              </li>
            </ul>
          </div>
        </nav>

        <div class="content-wrapper">       
            <div class="container-xxl flex-grow-1 container-p-y">
              <div class="card mb-4">
                <div class="card-body">
                  <div class="print-section">
                    <div class="card-body d-flex justify-content-between flex-xl-row flex-md-column flex-sm-row flex-column align-items-xl-center align-items-md-start align-items-sm-center align-items-start" style="background-color: #e6e6e6; border-radius: 10px; padding: 15px;">
                        <div class="mb-xl-0 mb-6 text-heading">
                          <div class="d-flex svg-illustration mb-6 gap-2 align-items-center">
                            <span class="app-brand-logo demo">
                                <img src="{{ url_for('static', filename='img/favicon.png') }}" alt="Logo" width="80">
                            </span>
                            <span class="app-brand-text1 demo fw-bold ms-50 lh-1" style="font-size: 24px; color: #4e5257">Sopon-Product Co.,Ltd.</span>
                          </div>
                          <p class="mb-2" style="font-size: 13px; color: #4e5257">9990 Sukhumvit Road, Khlong Tan,</p>
                          <p class="mb-2" style="font-size: 13px; color: #4e5257">Khlong Toei, Bangkok 10110, Thailand</p>
                        </div>
                        <div>
                          <h5 class="mb-6" style="color: #4e5257">{{ bill_info.doc_no }}</h5>
                          <div class="mb-1 text-heading">
                            <span style="color: #4e5257">Doc Date:</span>
                            <span class="fw-medium"><strong>{{ bill_info.doc_date }}</strong></span>
                          </div>
                        </div>
                    </div>
                    <div class="card-body">
                      <div class="row">
                        <div class="col-xl-6 col-md-12 col-sm-5 col-12 mb-xl-0 mb-md-6 mb-sm-0 mb-6">
                          <h6><strong>Customer Details:</strong></h6>
                          <p class="mb-1">{{ bill_info.cust_code }} {{ bill_info.cust_name }}</p>
                          <p class="mb-1">{{ bill_info.cust_eng }}</p>
                          <p class="mb-1">{{ bill_info.ship_address }}</p>
                        </div>
                        <div class="col-xl-6 col-md-12 col-sm-7 col-12">
                          <h6><strong>Detail:</strong></h6>
                          <table>
                            <tbody>
                              <tr>
                                <td class="pe-4">Salesman:</td>
                                <td class="fw-medium">{{ bill_info.sales_code }} {{ bill_info.sales_name }}</td>
                              </tr>
                              <tr>
                                <td class="pe-4">Ship To:</td>
                                <td>{{ bill_info.ship_to }}</td>
                              </tr>
                              <tr>
                                <td class="pe-4">Order No:</td>
                                <td>{{ bill_info.po_no }}</td>
                              </tr>
                              <tr>
                                <td class="pe-4">Due Date:</td>
                                <td>{{ bill_info.due_date }}</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                    <div class="card-body">
                      <div class="content">
                        <table class="table" id="welcome" style="color: #4e5257">
                          <thead>
                            <tr>
                              <th>Item Code</th>
                              <th>Description</th>
                              <th>Qty</th>
                              <th>Uom</th>
                              <th>Unit Price</th>
                              <th>Discount</th>
                              <th>Amount</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for row in bill_data %}
                            <tr>
                              <td>{{ row[13] }}</td>
                              <td>{{ row[14] }}</td>
                              <td>{{ row[15] }}</td>
                              <td>{{ row[16] }}</td>
                              <td>{{ row[17] }}</td>
                              <td>{{ row[18] }}</td>
                              <td>{{ row[19] }}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <div class="card-body table-responsive">
                      <table class="table m-0 table-borderless">
                        <tbody>
                          <tr>
                            <td class="align-top pe-6 ps-0 py-6 text-body">
                              <p class="mb-1">
                                <span class="me-2 h6"><strong>Remark:</strong></span>
                              </p>
                              <span>{{ bill_info.remark }}</span>
                            </td>
                            <td class="px-0 py-6 w-px-100">
                              <p class="mb-2" style="color: #4e5257">Subtotal:</p>
                              <p class="mb-2" style="color: #4e5257">Discount:</p>
                              <p class="mb-2 border-bottom pb-2" style="color: #4e5257">Tax:</p>
                              <p class="mb-0" style="color: #4e5257">Total:</p>
                              <p class="mb-0" style="color: #4e5257">Grand Total:</p>
                            </td>
                            <td class="text-end px-0 py-6 w-px-100 fw-medium text-heading">
                              <p class="fw-medium mb-2"><strong>{{ subtotal_formatted }}</strong></p>
                              <p class="fw-medium mb-2"><strong>{{ discount_formatted }}</strong></p>
                              <p class="fw-medium mb-2 border-bottom pb-2"><strong>{{ vat_formatted }}</strong></p>
                              <p class="fw-medium mb-0"><strong>{{ total_formatted }}</strong></p>
                              <p class="fw-medium mb-0"><strong>{{ Grand_total_formatted }}</strong></p>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <div class="mb-3">
                    <button id="printButton" class="btn btn-primary" onclick="printPage()"> Print</button>
                  </div>                
                </div>
              </div>
            </div>

            <footer class="content-footer footer bg-footer-theme">
                <div class="container-xxl d-flex flex-wrap justify-content-between py-2 flex-md-row flex-column">
                  <div class="mb-2 mb-md-0">
                    ©
                    <script>
                      document.write(new Date().getFullYear());
                    </script>
                    , Develop by Thanapurt Sopon
                    <a href="https://sales-performance-c3y2.onrender.com" target="_blank" class="footer-link fw-bolder">Sopon-Products Co.,Ltd</a>
                  </div>
                </div>
            </footer>

            <div class="content-backdrop fade"></div>
          </div>
        </div>
      </div>
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>

    <script src="{{ url_for('static', filename='js/table.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar/popper.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar/bootstrap.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar/perfect-scrollbar.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar/menu.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar/main.js') }}"></script>

    <script>
      function printPage() {
        window.print();
      }
    </script>      
  </body>
</html>
